$(document).ready(function(){const t="https://stormy-scrubland-44609.herokuapp.com";localStorage.getItem("token")?"/index.html"===window.location.pathname?$.ajax({type:"GET",url:t+"/entries/searchByUser/"+localStorage.getItem("userId"),contentType:"application/JSON",headers:{Authorization:localStorage.getItem("token")},success:function(t){t.length>1&&$(".entries-header").removeClass("hidden"),t.forEach((t,n)=>{$(".entries").append(e(t,n))})},error:function(t){swal("Something went wrong getting entries!\n\n(ó﹏ò｡)")}}):window.location.href="index.html":"/index.html"===window.location.pathname?window.location.href="landing.html":"/"===window.location.pathname&&(window.location.href="landing.html");let e=function(t,e){let n="";n+="<div>";let o=new Date(t.date);return n+='<p class="grateful-meta">'+moment(o).format("dddd, MMMM Do YYYY")+"</p>",n+="<ul>",n+='<li class="grateful-entry">'+t.gratefuls+"</li>",n+="</ul>",n+='<button class="edit-button" value="'+t._id+'"><span class="fa fa-plus"></span>edit</button>',n+='<button class="delete-button" value="'+t._id+'"><span class="fa fa-times"></span>delete</button>',n+="</div>"};$("body").on("click",".delete-button",function(e){let n=$(this).parent();swal({text:"Are you sure?\n\n⁀⊙﹏☉⁀",buttons:[!0,"delete"],dangerMode:!0}).then(e=>{e&&$.ajax({type:"DELETE",url:t+"/entries/delete/"+$(this).val(),contentType:"application/JSON",headers:{Authorization:localStorage.getItem("token")},success:function(t){n.remove()},error:function(t){console.log(t),swal("Something went wrong deleting!\n\n(ó﹏ò｡)")}})})}),$(".entry-button").on("click",function(n){if(n.preventDefault(),$("#first-grateful").val().trim().length<1)return void swal("Please write an entry...\n\n٩(●ᴗ●)۶");let o=[];$("textarea").each((t,e)=>{o.push($(e).val())});let a={gratefuls:o,name:"help",authorId:localStorage.getItem("userId")};$.ajax({type:"POST",url:t+"/entries",data:JSON.stringify(a),contentType:"application/JSON",headers:{Authorization:localStorage.getItem("token")},success:function(t){$(".entries-header").removeClass("hidden"),$(".entries").prepend(e(t.data,"-")),$(".gratefuls").html('<textarea id="first-grateful"></textarea>')},error:function(t){console.log(t),swal(" Something went wrong with saving entries!\n\nç(ó﹏ò｡)")}})}),$(".login-container form").submit(function(e){e.preventDefault();var n={username:$(this).find(".js-login").val(),password:$(this).find(".js-login-password").val(),date:moment().format("ddd, MMM Do YYYY")};$.ajax({type:"POST",url:t+"/auth/login",data:JSON.stringify(n),contentType:"application/JSON",success:function(t){localStorage.setItem("token",t.token),localStorage.setItem("userId",t.userId),window.location.href="/index.html"},error:function(t){console.log(t),swal("Username and/or password is wrong\n\n(ó﹏ò｡)")}})}),$("nav").on("click",".logout-button",function(){localStorage.clear(),window.location.href="/login.html"}),$(".signup-container form").submit(function(e){e.preventDefault();var n={username:$(this).find(".js-username").val(),password:$(this).find(".js-password").val(),date:moment().format("ddd, MMM Do YYYY")};$.ajax({type:"POST",url:t+"/auth/register",data:JSON.stringify(n),contentType:"application/JSON",success:function(t){swal("Your account has been created!\n\nPlease log in\n\n｡^‿^｡",{buttons:!1,timer:2500}),setTimeout(function(){window.location.href="/login.html"},2500)},error:function(t){console.log(t),swal(" Username already exists\n\n(ó﹏ò｡)")}})}),$("body").on("click",".edit-button",function(t){t.preventDefault();let e='<form class="edited-entry"><div class="gratefuls-edited"><textarea id="first-grateful" class="small-textarea" cols="37" wrap="hard">'+$(this).siblings("ul").text()+'</textarea></div><button class="save-edit-button submit-button" type="submit"><span class="fa fa-check"></span>save</button><button class="cancel-button submit-button" type="submit"><span class="fa fa-ban"></span>cancel</button></form>';$(this).siblings("ul").addClass("hidden"),$(this).siblings("button").addClass("hidden"),$(this).addClass("hidden"),$(this).parent("div").append(e)}),$("body").on("click",".save-edit-button",function(e){e.preventDefault();let n=$(".gratefuls-edited").children().val(),o=$(this).parents("form").siblings(".delete-button").attr("value"),a={gratefuls:n};$(this).parents("form").siblings("ul").html('<li class="grateful-entry">'+n+"</li>"),$(this).parents("form").siblings(".hidden").removeClass("hidden"),$(this).closest("form").remove(),function(e,n){$.ajax({type:"PUT",url:t+"/entries/"+n,data:JSON.stringify(e),contentType:"application/JSON",headers:{Authorization:localStorage.getItem("token")},success:function(t){},error:function(t){console.log(t),swal(" Something went wrong with editing entry!\n\n(ó﹏ò｡)")}})}(a,o)}),$("body").on("click",".cancel-button",function(t){t.preventDefault(),$(this).parents("form").siblings(".hidden").removeClass("hidden"),$(this).closest("form").remove()}),$("body").on("click",".landing-sign-up",function(t){window.location.href="/signup.html"}),$("body").on("click",".demo-button",function(t){window.location.href="/demo.html"}),$("body").on("click",".goto-login-button",function(t){window.location.href="/login.html"})});